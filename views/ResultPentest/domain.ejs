<%- contentFor('body') %>
<div class="container">
    <div class="main__container">
        <div class="main__header">
            <p class="main__heading">Report Domain Pentest</p>
            <p class="main__domain">
                <img src="https://img.icons8.com/external-soft-fill-juicy-fish/60/000000/external-domain-software-development-soft-fill-soft-fill-juicy-fish.png" width="30px" height="30px"/>
                Domain: <span class="domain__text"><%= domain %></span>
            </p>
        </div>

        <div class="main__result">
            <div class="result__icon-container">
                <div class="result__icon">
                    <!-- <i class="fas fa-check-double icon" title="This domain is safe"></i> -->
                    <!-- <i class="fas fa-exclamation icon danger" title="This domain is malicious"></i> -->
                </div>
                
            </div>
            <p class="result__number-container">
                <span class="number__service-warning">3</span><span> / 89</span>
            </p>
        </div>

        <div class="main__tables">
            <!-- <div class="risk-found">
                <table class="table table-striped">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col">Number</th>
                            <th scope="col">Services</th>
                            <th scope="col">Risk</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">1</th>
                            <td>Mark</td>
                            <td>Otto</td>
                        </tr>
                        <tr>
                            <th scope="row">2</th>
                            <td>Jacob</td>
                            <td>Thornton</td>
                        </tr>
                        <tr>
                            <th scope="row">3</th>
                            <td>Larry</td>
                            <td>the Bird</td>
                        </tr>
                    </tbody>
                </table>
            </div> -->
            <!-- <div class="no-risk">
                <p>No risk found. This domain is safe</p>
            </div> -->
        </div>

        <div class="main__detail-scan">
            <h3>Detail scan </h3>
            <div class="detail-scan">
                <ul class="list-group list-detail">
                    <li class="text-light list-group-item list-group-item-success d-flex justify-content-between align-items-center">
                        Trust
                        <span class="badge bg-primary rounded-pill" id="trust-number">77</span>
                    </li>
                    <li class="list-group-item list-group-item-secondary d-flex justify-content-between align-items-center">
                        Unrated
                        <span class="badge bg-primary rounded-pill" id="unrated-number">11</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
    const data = JSON.parse('<%- JSON.stringify(data) %>');
    console.log(data);

    const resultSerives = data.result ?? [];

    const numberWarning = document.querySelector('.number__service-warning')
    const trustNumber = document.querySelector('#trust-number');
    const unratedNumber = document.querySelector('#unrated-number');

    trustNumber.innerHTML = data.trust;
    unratedNumber.innerHTML = data.unrated;
    numberWarning.innerHTML = data.distrust;

    const mainTable = document.querySelector('.main__tables');
    const resultIcon = document.querySelector('.result__icon');

    if (data.distrust === 0) {
        numberWarning.classList.add('success');
        resultIcon.innerHTML = `<i class="fas fa-check-double icon" title="This domain is safe"></i>`;
        mainTable.innerHTML = `
            <div class="no-risk">
                <p>No risk found. This domain is safe</p>
            </div>`;
    } else {
        resultIcon.innerHTML = `<i class="fas fa-exclamation icon danger" title="This domain is malicious"></i>`;
        let tableHTML = `
            <div class="risk-found">
                <table class="table table-striped table-hover">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col">Number</th>
                            <th scope="col">Services</th>
                            <th scope="col">Risk</th>
                        </tr>
                    </thead>
                    <tbody>`;
        
        const str = resultSerives.map((service, index) => {
            const key = Object.keys(service)[0];
            const html = `
                <tr>
                    <th scope="row">${index + 1}</th>
                    <td>${key}</td>
                    <td>${service[key]}</td>
                </tr>
            `;
            return html;
        });

        tableHTML += str.join('') + `
                    </tbody>
                </table>
            </div>`;

        mainTable.innerHTML = tableHTML;
    }

</script>
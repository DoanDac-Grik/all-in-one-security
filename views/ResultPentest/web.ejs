<%- contentFor('body') %>
<div>
    <div class="main__container">
        <div class="main__header">
            <p class="main__heading">Report web pentest</p>

            <p class="main__heading-url">
                <i class="fas fa-check check-icon"></i> URL: <span class="heading-url"><%= url %></span> 
            </p> 
        </div>

        <div class="main__statitics-container">
            <div class="statitics-symbol-container">
                <ul class="symbol-list">
                    <li class="symbol-item">
                        <i class="fas fa-times-circle symbol-high"></i>
                        <span>High (<span class="high-risk-number">0</span>)</span>
                    </li>
                    <li class="symbol-item">
                        <i class="fas fa-exclamation-triangle symbol-medium"></i>
                        <span>Medium (<span class="medium-risk-number">0</span>) </span>
                    </li>
                    <li class="symbol-item">
                        <i class="fas fa-check-circle symbol-low"></i>
                        <span>Low (<span class="low-risk-number">2</span>)</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="main__table-container container">
            <div class="table-responsive">
                <table class="table table-hover table-striped table-bordered table-report">
                    <thead class="table-report-heading">
                        <tr class="table-dark">
                            <th scope="col" style="width: 4%;">Risk</th>
                            <th scope="col" style="width: 10%;">Name</th>
                            <th scope="col" style="width: 26%;">Description</th>
                            <th scope="col" style="width: 30%;">Solution</th>
                            <th scope="col" style="width: 30%;">Reference</th>
                        </tr>
                    </thead>
                    <tbody class="table__report-data">
                        <tr>
                            <td>
                                <i class="fas fa-check-circle symbol-low"></i>
                            </td>
                            <td >Information Disclosure - Suspicious Comments</td>
                            <td >
                                The response appears to contain suspicious comments which may help an attacker. 
                                Note: Matches made within script blocks or files are against the entire content not only comments.
                            </td>
                            <td >
                                Remove all comments that return information that may help an attacker and fix any underlying problems they refer to.
                            </td>
                            <td>
                                <a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching">https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching</a>
                                <br>
                                <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    const highRiskNumber = document.querySelector('.high-risk-number');
    const mediumRiskNumber = document.querySelector('.medium-risk-number');
    const lowRiskNumber = document.querySelector('.low-risk-number');
    const reportData = document.querySelector('.table__report-data')
    const reports = JSON.parse('<%- JSON.stringify(reports) %>');
    console.log(reports);
    let highNum = 0;
    let mediumNum = 0;
    let lowNum = 0;

    const tableHTML = reports.map(report => {
        let iconHTML = ''
        if (report.riskcode == '0') {
            lowNum++;
            iconHTML = `<i class="fas fa-check-circle symbol-low"></i>`;
        } else if (report.riskcode == '1') {
            mediumNum++;
            iconHTML = `<i class="fas fa-exclamation-triangle symbol-medium"></i>`;
        } else {
            highNum++;
            iconHTML = `<i class="fas fa-times-circle symbol-high"></i>`;
        }
        return `
            <tr>
                <td>
                    ${iconHTML}
                </td>
                <td>
                    ${report.name}
                </td>
                <td>
                    ${report.desc}
                </td>
                <td>
                    ${report.solution}
                </td>
                <td>
                    ${report.reference == '<p></p>' ? `No reference` : report.reference}
                </td>
            </tr>
        `;
    }).join('');

    reportData.innerHTML = tableHTML;

    highRiskNumber.innerHTML = highNum;
    mediumRiskNumber.innerHTML = mediumNum;
    lowRiskNumber.innerHTML = lowNum;
</script>
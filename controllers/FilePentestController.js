const virusTotalHelper = require('../helpers/virusTotalHelper');
class FilePentestController {
    //[GET] /
    showFilePentest(req, res, next) {
        res.render('Pentest/file', {
            'title': 'Scan file',
            'css': 'file'
        });
    }
    //[POST] /submit-hash
    submitHash(req, res, next) {
        console.log(req.body.hash);
        res.redirect(`scan-result?hash=${req.body.hash}`);
    }
    //[GET] /scan-result
    fileScan(req,res,next){
        const hash = req.query.hash;
        const options = {
            method: 'GET',
            headers: {
              Accept: 'application/json',
                'x-apikey': '8636535d7444c09c95dd52f6854cb623e1c86b83cfe816726b1df1968e67557b'
            }
        };
        virusTotalHelper.checkFile(hash,options)
        .then( ok => {
            //const result =ok.data.data[0].attributes.popular_threat_classification;
            const result = ok.data;
            res.send(result);
        })
    }
}
module.exports = new FilePentestController();
var fileContainer = document.querySelector('.file__container');
var fileActionBtn = document.querySelector('.main__file-btn-container');
var inputFiles = document.querySelectorAll('.input__file-btn');
const optionAction = document.querySelector('.option-action-container');
const inputHash = document.querySelector('#hash__input');
const form = document.querySelector('.form__upload-file');

const serviceBtns = document.querySelectorAll('.service-btn');
serviceBtns.forEach(serviceBtn => {
    serviceBtn.addEventListener('click', (e) => {
        const serClick = e.target.closest('.service-action__container').querySelector('.service-btn-click');
        serClick.classList.remove('service-btn-click');
        e.target.classList.add('service-btn-click');
        const label = e.target.id;
        if (label === 'descrypt') {
            document.querySelector('.decrypt-key').innerHTML = `
                <label for="secretDescrypt">Secret key for descrypt: </label>
                <input type="text" name="secretDescrypt" id="secretDescrypt" required>
            `;
            form.action = '/encrypt-file/file-decrypt';
        } else {
            form.action = '/encrypt-file/file-encrypt';
            document.querySelector('.decrypt-key').innerHTML = ``;
        }
    })
});

inputFiles.forEach((inputFile) => {
    inputFile.addEventListener('change', function (e) {
        var file = this.files[0];
        fileContainer.innerHTML = `
            <div class="file">
                <span class="file-name">${file['name']}</span>
                <span class="btn file-close-btn">
                    <i class="far fa-times-circle"></i>
                </span>
            </div>
        `;

        fileActionBtn.querySelector('input[type="submit"]').classList.remove('hide');
        fileActionBtn.querySelector('label.btn-file').classList.add('hide');

        var fileUploadBtn = fileContainer.querySelector('.file-close-btn');
        fileUploadBtn.addEventListener('click', function() {
            // Reset form
            this.closest('.form__upload-file').reset();

            // Remove file
            fileContainer.innerHTML = "";

            fileActionBtn.querySelector('input[type="submit"]').classList.add('hide');
            fileActionBtn.querySelector('label.btn-file').classList.remove('hide');
        })
    })
});


